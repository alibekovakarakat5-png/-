# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã - Network Error —É—Å—Ç—Ä–∞–Ω—ë–Ω

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Network Error –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–∫–∞–∑—ã–≤–∞–ª "Network Error" –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ –∑–≤–æ–Ω–∫–æ–≤

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: 
- –û—à–∏–±–∫–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤–∞ –≤ `GET /api/calls`: `[items, total] = await Promise.all([...])` –≤—ã–∑—ã–≤–∞–ª–∞ –æ—à–∏–±–∫—É "Cannot set properties of undefined (setting '0')"
- SQLite –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `mode: 'insensitive'` –≤ Prisma queries

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è: —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –ø–æ—Ç–æ–º –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º
- ‚úÖ –£–±—Ä–∞–Ω–æ `mode: 'insensitive'` –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ `managerName` (SQLite –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `processRouter` –≤ `app.ts`
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î —Å try-catch

### 2. Cron –∑–∞–¥–∞—á–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ pending –∑–≤–æ–Ω–∫–æ–≤ ‚úÖ
**–ò–∑–º–µ–Ω–µ–Ω–æ**: 
- ‚úÖ Cron –∏–∑–º–µ–Ω—ë–Ω —Å `*/5 * * * *` (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç) –Ω–∞ `* * * * *` (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ –∏ –æ—à–∏–±–æ–∫

### 3. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ `[${new Date().toISOString()}]` –≤–æ –≤—Å–µ –ª–æ–≥–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ë–î —Å stack trace
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ cron –∑–∞–¥–∞—á

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### Backend Endpoints
- ‚úÖ `GET /api/health` ‚Üí `{"status":"ok"}` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `GET /api/calls` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON —Å `items`, `page`, `pageSize`, `total` - —Ä–∞–±–æ—Ç–∞–µ—Ç

### Cron –∑–∞–¥–∞—á–∏
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Bitrix: –∫–∞–∂–¥—ã–µ `BITRIX_SYNC_INTERVAL_MINUTES` –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ pending –∑–≤–æ–Ω–∫–æ–≤: **–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É** (`* * * * *`)

### –°—Ç–∞—Ç—É—Å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í –±–∞–∑–µ 32 –∑–≤–æ–Ω–∫–∞
- ‚úÖ Endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∏ –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å `analyzed`

## üìã –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **backend/src/app.ts**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `processRouter`
   - ‚úÖ –ò–∑–º–µ–Ω—ë–Ω cron –Ω–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É (`* * * * *`)
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏

2. **backend/src/routes/calls.ts**
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
   - ‚úÖ –£–±—Ä–∞–Ω–æ `mode: 'insensitive'` –¥–ª—è SQLite
   - ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:**

- ‚úÖ Backend –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Health endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Calls endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–æ

**–§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω —Ç–µ–ø–µ—Ä—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–≤–æ–Ω–∫–æ–≤ –±–µ–∑ Network Error.**

## üìù –õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ backend –±—É–¥—É—Ç –ª–æ–≥–∏:
```
[2025-11-27T...] GET /api/calls - Query: {...}
[2025-11-27T...] Executing database query with where: {...}
[2025-11-27T...] Query successful: X items, total: Y
[2025-11-27T...] Sending response: X items
```

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ cron:
```
[2025-11-27T...] Checking for pending calls to process...
[2025-11-27T...] Processed X pending calls, Y errors
```

